# RostraCore Backend - Production Environment Variables
# Copy this file to .env and fill in your production values
# DO NOT commit .env to version control!

###############################################################################
# DATABASE CONFIGURATION
###############################################################################

# PostgreSQL connection string
# Format: postgresql://username:password@host:port/database
DATABASE_URL=postgresql://rostracore_user:YOUR_STRONG_PASSWORD@localhost:5432/rostracore_prod

# Database pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

###############################################################################
# REDIS & CACHING
###############################################################################

# Redis connection
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=YOUR_REDIS_PASSWORD
REDIS_DB=0
REDIS_SSL=false

# Cache TTL settings (in seconds)
CACHE_DEFAULT_TTL=300
CACHE_DASHBOARD_EXECUTIVE_TTL=300
CACHE_DASHBOARD_OPERATIONS_TTL=120
CACHE_DASHBOARD_FINANCIAL_TTL=600
CACHE_DASHBOARD_PEOPLE_TTL=300

###############################################################################
# CELERY CONFIGURATION
###############################################################################

# Celery broker and result backend
CELERY_BROKER_URL=redis://:YOUR_REDIS_PASSWORD@localhost:6379/0
CELERY_RESULT_BACKEND=redis://:YOUR_REDIS_PASSWORD@localhost:6379/0

# Celery settings
CELERY_TASK_ALWAYS_EAGER=false
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=Africa/Johannesburg
CELERY_ENABLE_UTC=true

###############################################################################
# API CONFIGURATION
###############################################################################

# API server settings
API_HOST=0.0.0.0
API_PORT=8000
API_V1_PREFIX=/api/v1
API_TITLE=RostraCore API
API_VERSION=1.0.0

# CORS settings - IMPORTANT: Set to your actual domain(s)
ALLOWED_ORIGINS=["https://yourdomain.com","https://www.yourdomain.com","https://app.yourdomain.com"]

# Request limits
API_MAX_REQUEST_SIZE=10485760  # 10MB
API_REQUEST_TIMEOUT=300  # 5 minutes

###############################################################################
# SECURITY & AUTHENTICATION
###############################################################################

# JWT Secret Key - MUST be at least 32 characters, randomly generated
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=YOUR_SUPER_SECRET_KEY_MIN_32_CHARS_RANDOMLY_GENERATED

# JWT settings
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# Password hashing
BCRYPT_ROUNDS=12

###############################################################################
# MONITORING & ERROR TRACKING (SENTRY)
###############################################################################

# Sentry configuration
# Sign up at https://sentry.io and create a project
SENTRY_DSN=https://YOUR_SENTRY_KEY@o123456.ingest.sentry.io/PROJECT_ID
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1
SENTRY_SEND_DEFAULT_PII=false
SENTRY_RELEASE=rostracore@1.0.0

# Enable Sentry features
SENTRY_ENABLE_TRACING=true
SENTRY_DEBUG=false

###############################################################################
# APPLICATION SETTINGS
###############################################################################

# Environment
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO

# Timezone
TIMEZONE=Africa/Johannesburg

# Feature flags
ENABLE_ANALYTICS=true
ENABLE_PREDICTIONS=true
ENABLE_ASYNC_JOBS=true

###############################################################################
# EMAIL CONFIGURATION (Optional - for notifications)
###############################################################################

# SMTP settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@yourdomain.com
SMTP_PASSWORD=YOUR_EMAIL_PASSWORD
SMTP_FROM=noreply@yourdomain.com
SMTP_FROM_NAME=RostraCore

# Email features
ENABLE_EMAIL_NOTIFICATIONS=false

###############################################################################
# FILE STORAGE (Optional - for exports, attachments)
###############################################################################

# Local storage
UPLOAD_DIR=/var/rostracore/uploads
MAX_UPLOAD_SIZE=10485760  # 10MB

# S3 storage (optional)
USE_S3_STORAGE=false
S3_BUCKET=rostracore-uploads
S3_REGION=af-south-1
S3_ACCESS_KEY=YOUR_AWS_ACCESS_KEY
S3_SECRET_KEY=YOUR_AWS_SECRET_KEY

###############################################################################
# BUSINESS LOGIC SETTINGS
###############################################################################

# Roster generation
ROSTER_MAX_ITERATIONS=1000
ROSTER_OPTIMIZATION_TIMEOUT=300  # 5 minutes

# Predictions
PREDICTION_CONFIDENCE_THRESHOLD=0.7
CHURN_RISK_HIGH_THRESHOLD=0.5
CHURN_RISK_CRITICAL_THRESHOLD=0.7

# Analytics
ANALYTICS_RETENTION_DAYS=365
ANALYTICS_AGGREGATION_ENABLED=true

###############################################################################
# RATE LIMITING (Optional - requires slowapi)
###############################################################################

# Rate limiting
ENABLE_RATE_LIMITING=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

###############################################################################
# BACKUP SETTINGS
###############################################################################

# Automatic backup settings
BACKUP_ENABLED=true
BACKUP_DIR=/var/backups/rostracore
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM

###############################################################################
# PERFORMANCE TUNING
###############################################################################

# Database query optimization
ENABLE_QUERY_LOGGING=false
SLOW_QUERY_THRESHOLD=500  # Log queries slower than 500ms

# API performance
ENABLE_GZIP_COMPRESSION=true
ENABLE_RESPONSE_CACHING=true

# Background job performance
CELERY_WORKER_CONCURRENCY=4
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000

###############################################################################
# COMPLIANCE & SECURITY
###############################################################################

# POPIA compliance (South African data protection)
ENABLE_POPIA_COMPLIANCE=true
DATA_RETENTION_DAYS=365
ENABLE_AUDIT_LOGGING=true

# Security headers
ENABLE_SECURITY_HEADERS=true
ENABLE_CSRF_PROTECTION=true

###############################################################################
# DEVELOPMENT & DEBUGGING (Set to false in production!)
###############################################################################

# IMPORTANT: All these should be false in production
DEBUG_MODE=false
ENABLE_HOT_RELOAD=false
ENABLE_DEBUG_TOOLBAR=false
ENABLE_PROFILER=false

###############################################################################
# NOTES
###############################################################################

# 1. Generate SECRET_KEY with:
#    python -c "import secrets; print(secrets.token_urlsafe(32))"
#
# 2. Create PostgreSQL database and user:
#    CREATE DATABASE rostracore_prod;
#    CREATE USER rostracore_user WITH PASSWORD 'YOUR_STRONG_PASSWORD';
#    GRANT ALL PRIVILEGES ON DATABASE rostracore_prod TO rostracore_user;
#
# 3. Set up Redis with authentication:
#    Edit /etc/redis/redis.conf and set: requirepass YOUR_REDIS_PASSWORD
#
# 4. Get Sentry DSN from https://sentry.io project settings
#
# 5. Ensure .env file has proper permissions:
#    chmod 600 .env
#
# 6. Never commit .env to git! Check .gitignore includes .env
